%       Sellmeier
%       Index of refraction, based on Sellmeier formula
%	   Various sources imported from GSolver (comercial code written by David Fluckiger).
%       
% Usage:
%	nk = Sellmeier(name, lambda)
%		name:	text name (see below)
%		lambda: free-space wavelength in microns
%	
%	   Copyright (c) 2020 David Fluckiger
%       Author: David Fluckiger
%       Date: May 2020, revision: 1.0
%
%
% Permission is hereby granted, free of charge, to any person obtaining a copy of this software 
% and associated documentation files (the "Software"), to deal in the Software without restriction, 
% including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, 
% and/or sell copies of the Software, and to permit persons to whom the Software is furnished to 
% do so, subject to the following conditions:
% 
% The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
%function nk = Sellmeier(name,lambda)
switch name
	case 'FusedSilica'
		p = [0.5, 1, 0.696166, 0.407943, 0.897479, 0, 0, 0.00467915, 0.0135121, 97.934, 0, 0];
	case 'Ultran20'
		p = [0.5, 1, 0.791425, 0.39677, 0.940527, 0, 0, 0.00367194, 0.0126061, 173.396, 0, 0];
	case 'Ultran30'
		p = [0.5, 1, 0.730713, 0.636952, 0.856177, 0, 0, 0.00314818, 0.012991, 143.605, 0, 0];
	case 'BK7'
		p = [0.5, 1, 1.03961, 0.231792, 1.01147, 0, 0, 0.0060007, 0.0200179, 103.561, 0, 0];
	case 'FK5'
		p = [0.5, 1, 0.844309, 0.344148, 0.91079, 0, 0, 0.00475112, 0.0149815, 97.86, 0, 0];
	case 'FK3'
		p = [ 0.5, 1, 0.973347, 0.146642, 0.679304, 0, 0, 0.00640795, 0.0205653, 80.4965, 0, 0];
	case 'FK51'
		p = [ 0.5, 1, 0.971248, 0.216901, 0.904652, 0, 0, 0.00472302, 0.0153576, 168.681, 0, 0];
	case 'PSK3'
		p = [ 0.5, 1, 0.887272, 0.489592, 1.04865, 0, 0, 0.00469824, 0.0161818, 104.375, 0, 0];
	case 'PSK53A'
		p = [0.5, 1, 1.34341, 0.241418, 0.952897, 0, 0, 0.00675074, 0.0219911, 103.551, 0, 0];
	case 'K5'
		p = [0.5, 1, 1.08512, 0.199562, 0.930512, 0, 0, 0.006611, 0.0241109, 111.983, 0, 0];
	case 'K7'
		p = [0.5, 1, 1.12736, 0.124412, 0.827101, 0, 0, 0.00720342, 0.0269836, 100.385, 0, 0];
	case 'ZKN7'
		p = [0.5, 1, 1.07715, 0.168079, 0.85189, 0, 0, 0.00676602, 0.0230643, 89.0469, 0, 0];
	case 'BaK1'
		p = [0.5, 1, 1.12366, 0.309277, 0.881512, 0, 0, 0.00644743, 0.0222284, 107.298, 0, 0];
	case 'BaK2'
		p = [0.5, 1, 1.01662, 0.319903, 0.937233, 0, 0, 0.00592384, 0.0203828, 113.118, 0, 0];
	case 'BaK4'
		p = [0.5, 1, 1.22966, 0.191513, 0.95689, 0, 0, 0.00723553, 0.0277771, 109.687, 0, 0];
	case 'SK2'
		p = [0.5, 1, 1.28189, 0.257738, 0.968186, 0, 0, 0.00727192, 0.0242824, 110.378, 0, 0];
	case 'SK4'
		p = [0.5, 1, 1.39389, 0.164511, 0.963522, 0, 0, 0.00769147, 0.0271946, 99.2758, 0, 0];
	case 'SK5'
		p = [0.5, 1, 0.991464, 0.495982, 0.987394, 0, 0, 0.0052273, 0.0172734, 98.3595, 0, 0];
	case 'SK10'
		p = [0.5, 1, 1.31659, 0.271656, 0.968688, 0, 0, 0.00712229, 0.0244417, 105.082, 0, 0];
	case 'SK14'
		p = [0.5, 1, 0.936155, 0.594052, 1.04375, 0, 0, 0.00461717, 0.0168859, 103.736, 0, 0];
	case 'SK15'
		p = [0.5, 1, 1.29173, 0.298393, 0.955518, 0, 0, 0.00686358, 0.0228704, 97.4779, 0, 0];
	case 'SK16'
		p = [0.5, 1, 1.34318, 0.241144, 0.994318, 0, 0, 0.00704687, 0.0229005, 92.7509, 0, 0];
	case 'SK18A'
		p = [0.5, 1, 1.53857, 0.0985934, 1.0231, 0, 0, 0.00863201, 0.0367156, 100.118, 0, 0];
	case 'BaLF4'
		p = [0.5, 1, 1.29376, 0.158139, 0.947443, 0, 0, 0.00780228, 0.0321349, 109.159, 0, 0];
	case 'BaLF5'
		p = [0.5, 1, 1.23751, 0.116758, 0.853086, 0, 0, 0.00808113, 0.0349868, 110.314, 0, 0];
	case 'SSKN5'
		p = [0.5, 1, 1.59223, 0.103521, 1.05174, 0, 0, 0.00920285, 0.042353, 106.927, 0, 0];
	case 'SSKN8'
		p = [0.5, 1, 1.46998, 0.0963559, 1.02611, 0, 0, 0.00903675, 0.0450076, 108.329, 0, 0];
	case 'LaKN7'
		p = [0.5, 1, 1.2368, 0.445052, 1.01746, 0, 0, 0.00610106, 0.0201388, 90.638, 0, 0];
	case 'LaK8'
		p = [0.5, 1, 1.33183, 0.546623, 1.19084, 0, 0, 0.00620024, 0.0216465, 82.5828, 0, 0];
	case 'LaK9'
		p = [0.5, 1, 1.46232, 0.3444, 1.15508, 0, 0, 0.0072427, 0.0243353, 85.4687, 0, 0];
	case 'LaK10'
		p = [0.5, 1, 1.67483, 0.222669, 1.13957, 0, 0, 0.00849325, 0.0330463, 80.4373, 0, 0];
	case 'LaKN13'
		p = [0.5, 1, 1.25792, 0.553403, 1.06336, 0, 0, 0.00621495, 0.021681, 104.494, 0, 0];
	case 'LaKN22'
		p = [0.5, 1, 1.1423, 0.535138, 1.04088, 0, 0, 0.00585779, 0.0198546, 100.834, 0, 0];
	case 'LLF6'
		p = [0.5, 1, 1.20067, 0.103689, 0.954739, 0, 0, 0.00851611, 0.0418805, 114.99, 0, 0];
	case 'BaF4'
		p = [0.5, 1, 1.37493, 0.146355, 0.912643, 0, 0, 0.00929554, 0.0440427, 116.608, 0, 0];
	case 'BaFN10'
		p = [0.5, 1, 1.60477, 0.123762, 1.07271, 0, 0, 0.000947022, 0.045164, 108.539, 0, 0];
	case 'BaF50'
		p = [0.5, 1, 1.63007, 0.135169, 1.1533, 0, 0, 0.0100983, 0.045458, 121.435, 0, 0];
	case 'BaF51'
		p = [0.5, 1, 1.5323, 0.136199, 1.12287, 0, 0, 0.0096827, 0.0448276, 123.776, 0, 0];
	case 'BaF52'
		p = [0.5, 1, 1.41632, 0.117331, 0.934115, 0, 0, 0.00928783, 0.044991, 114.126, 0, 0];
	case 'LF5'
		p = [0.5, 1, 1.28036, 0.163506, 0.89393, 0, 0, 0.00929854, 0.0449136, 110.494, 0, 0];
	case 'F2'
		p = [0.5, 1, 1.34533, 0.209073, 0.937357, 0, 0, 0.00997744, 0.0470451, 111.887, 0, 0];
	case 'F5'
		p = [0.5, 1, 1.31045, 0.196034, 0.96613, 0, 0, 0.00958633, 0.0457628, 115.012, 0, 0];
	case 'FN11'
		p = [0.5, 1, 1.41573, 1.43334, 1.27299, 0, 0, 0.0103747, 0.0568804, 119.664, 0, 0];
	case 'BaSF2'
		p = [0.5, 1, 1.47886, 0.212805, 0.996611, 0, 0, 0.0104304, 0.0494154, 120.576, 0, 0];
	case 'BaSF51'
		p = [0.5, 1, 1.67507, 0.212822, 0.966557, 0, 0, 0.0105667, 0.0476665, 92.0389, 0, 0];
	case 'LaF2'
		p = [0.5, 1, 1.75302, 0.213979, 1.09939, 0, 0, 0.00935724, 0.0402787, 102.533, 0, 0];
	case 'LaF3'
		p = [0.5, 1, 1.73156, 0.150874, 1.06587, 0, 0, 0.00953834, 0.0407887, 98.0759, 0, 0];
	case 'LaFN7'
		p = [0.5, 1, 1.66843, 0.298513, 1.07744, 0, 0, 0.010316, 0.0469216, 82.5079, 0, 0];
	case 'LaFN21'
		p = [0.5, 1, 1.88298, 0.240215, 1.23538, 0, 0, 0.0093603, 0.0354026, 84.392, 0, 0];
	case 'LaF22'
		p = [0.5, 1, 1.86985, 0.219921, 1.34141, 0, 0, 0.0109833, 0.0508017, 114.556, 0, 0];
	case 'LaSF3'
		p = [0.5, 1, 1.95904, 0.219801, 1.33464, 0, 0, 0.0104347, 0.0465504, 87.9058, 0, 0];
	case 'LaSFN3'
		p = [0.5, 1, 1.71317, 0.718575, 1.72332, 0, 0, 0.00819172, 0.0297802, 138.461, 0, 0];
	case 'SF1'
		p = [0.5, 1, 1.55913, 0.284246, 0.968843, 0, 0, 0.0121481, 0.0534549, 112.175, 0, 0];
	case 'SF2'
		p = [0.5, 1, 1.40302, 0.231768, 0.939057, 0, 0, 0.0105795, 0.0493227, 112.406, 0, 0];
	case 'SF6'
		p = [0.5, 1, 1.72448, 0.390105, 1.04573, 0, 0, 0.0134872, 0.0569318, 118.557, 0, 0];
	case 'SF8'
		p = [0.5, 1, 1.49514, 0.26253, 0.969568, 0, 0, 0.011499, 0.051717, 113.459, 0, 0];
	case 'SF10'
		p = [0.5, 1, 1.61626, 0.259229, 1.07762, 0, 0, 0.0127535, 0.0581984, 116.608, 0, 0];
	case 'SF14'
		p = [0.5, 1, 1.69183, 0.28592, 1.12595, 0, 0, 0.0133152, 0.0612647, 118.405, 0, 0];
	case 'SF15'
		p = [0.5, 1, 1.53926, 0.247621, 1.03816, 0, 0, 0.0119308, 0.0556078, 116.417, 0, 0];
	case 'SF57'
		p = [0.5, 1, 1.81651, 0.428894, 1.07186, 0, 0, 0.0143704, 0.0592801, 121.42, 0, 0];
	otherwise
		p = -1;
end

if p(1)<0
	nk = [1, 0];
else
	n = p(2) + sum(p(3:7)*lambda^2./(lambda^2-p(8:12)));
	n = n^p(1);
	nk = [n,0];
end